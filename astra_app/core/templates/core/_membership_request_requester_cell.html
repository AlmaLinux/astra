{% comment %}
Requester info for membership request list rows.

Renders the "Requested for" cell content: the target user/organization link,
the "Requested by" attribution when it differs, and the compact membership notes.

Expected context (inherited from parent via {% include %}):
- row: dict with r, organization, full_name, requested_by_username, etc.
- r: row.r (MembershipRequest)
{% endcomment %}

{% load core_membership_notes %}

<div>
  {% include 'core/_membership_request_target_display.html' with req=r full_name=row.full_name target_deleted=False %}
</div>

{% if row.requested_by_username %}
  {% if r.is_user_target and row.requested_by_username != r.requested_username or r.is_organization_target and row.organization %}
    <div class="text-muted small">
      Requested by:
      <a href="{% url 'user-profile' row.requested_by_username %}">
        {% if row.requested_by_full_name %}
          {{ row.requested_by_full_name }} <span class="text-muted">({{ row.requested_by_username }})</span>
        {% else %}
          {{ row.requested_by_username }}
        {% endif %}
      </a>
      {% if row.requested_by_deleted %}
        <span class="text-muted">(deleted)</span>
      {% endif %}
    </div>
  {% endif %}
{% endif %}

<div class="mt-2">
  {% membership_notes r compact=True %}
</div>
