{% load tz %}

{% timezone 'UTC' %}
  {% now "Y-m-d" as min_expiration_on_utc %}
{% endtimezone %}

<button type="button" class="btn btn-sm btn-outline-secondary" data-toggle="modal" data-target="#{{ expiry_modal_id }}" title="Edit membership expiration date">Edit expiration</button>

{% if expiry_value %}
  {% timezone 'UTC' %}
    {% with initial_value=expiry_value|date:'Y-m-d' current_expiration=expiry_value|date:"M j, Y" %}
      {% include 'core/_modal_expiry_and_terminate.html' with modal_id=expiry_modal_id title=modal_title expiry_action_url=expiry_action_url terminate_action_url=terminate_action_url input_id=expires_input_id next_url=next_url label=expiry_label initial_value=initial_value min_value=min_expiration_on_utc current_text="Current expiration: "|add:current_expiration|add:current_text_suffix help_text="Expiration is an end-of-day date in UTC." terminator=terminator membership_type_name=membership_type_name %}
    {% endwith %}
  {% endtimezone %}
{% else %}
  {% include 'core/_modal_expiry_and_terminate.html' with modal_id=expiry_modal_id title=modal_title expiry_action_url=expiry_action_url terminate_action_url=terminate_action_url input_id=expires_input_id next_url=next_url label=expiry_label min_value=min_expiration_on_utc help_text="Expiration is an end-of-day date in UTC." terminator=terminator membership_type_name=membership_type_name %}
{% endif %}
