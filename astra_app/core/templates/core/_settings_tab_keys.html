<form method="post" novalidate data-settings-save-all="1">
	{% csrf_token %}
	<input type="hidden" name="tab" value="keys" />

	{% if keys_form.non_field_errors %}
		<div class="alert alert-danger">{{ keys_form.non_field_errors }}</div>
	{% endif %}

	{% include 'core/_form_field_widget_fallback.html' with field=keys_form.fasGPGKeyId widget_id='gpg-keys-widget' fallback_id='gpg-keys-fallback' table_id='gpg-keys-table' add_button_id='gpg-keys-add' add_button_title='Add another GPG key ID' add_button_text='Add GPG key ID' %}

	{% include 'core/_form_field_widget_fallback.html' with field=keys_form.ipasshpubkey widget_id='ssh-keys-widget' fallback_id='ssh-keys-fallback' table_id='ssh-keys-table' add_button_id='ssh-keys-add' add_button_title='Add another SSH key' add_button_text='Add SSH key' %}

	<button type="submit" class="btn btn-primary" title="Save key settings">Save</button>
</form>

<script>
	(function () {
		function onReady(fn) {
			if (document.readyState === 'loading') {
				document.addEventListener('DOMContentLoaded', fn);
			} else {
				fn();
			}
		}

		onReady(function () {
			setupRowEditor({
				textareaId: 'id_fasGPGKeyId',
				widgetId: 'gpg-keys-widget',
				fallbackId: 'gpg-keys-fallback',
				tableBodySelector: '#gpg-keys-table tbody',
				addBtnId: 'gpg-keys-add',
				rowClass: 'gpg-keys-row',
				kind: 'text',
				placeholder: 'Key ID'
			});

			setupRowEditor({
				textareaId: 'id_ipasshpubkey',
				widgetId: 'ssh-keys-widget',
				fallbackId: 'ssh-keys-fallback',
				tableBodySelector: '#ssh-keys-table tbody',
				addBtnId: 'ssh-keys-add',
				rowClass: 'ssh-keys-row',
				kind: 'textarea',
				placeholder: 'Paste a key'
			});
		});
	})();
</script>
