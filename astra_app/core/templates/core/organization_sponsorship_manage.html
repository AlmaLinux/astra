{% extends 'core/base.html' %}

{% block title %}Manage sponsorship - {{ organization.name }}{% endblock %}

{% block header %}
  <div class="d-flex align-items-center justify-content-between flex-wrap" style="gap: .5rem;">
    <h1 class="m-0">Manage sponsorship</h1>
    <a href="{% url 'organization-detail' organization.pk %}" class="btn btn-sm btn-outline-secondary" title="Return to organization details">Back to organization</a>
  </div>
{% endblock %}

{% block content %}
  <div class="organization-page">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title mb-0">{{ organization.name }}</h3>
      </div>
      <div class="card-body">
        {% if pending_membership_level_request %}
          <div class="callout callout-info">
            A sponsorship request is currently <strong>{{ pending_membership_level_request.get_status_display }}</strong>.
            <div class="mt-1">
              <a href="{% url 'membership-request-self' pending_membership_level_request.pk %}">View request</a>
            </div>
          </div>
        {% endif %}

        <div class="mb-3 text-muted">
          Use this page to request sponsorship or request a sponsorship level change.
          The Membership Committee will review your request.
          Learn more at <a href="https://almalinux.org/members" rel="noopener noreferrer">almalinux.org/members</a>.
        </div>

        <form method="post" novalidate>
          {% csrf_token %}

          {% if form.non_field_errors %}
            <div class="alert alert-danger" role="alert">{{ form.non_field_errors }}</div>
          {% endif %}

          <div class="form-group">
            <label for="{{ form.membership_level.id_for_label }}">{{ form.membership_level.label }}</label>
            {{ form.membership_level }}
            {% if form.membership_level.errors %}<div class="text-danger">{{ form.membership_level.errors }}</div>{% endif %}
          </div>

          <div class="form-group mb-0">
            <label for="{{ form.additional_information.id_for_label }}">{{ form.additional_information.label }}</label>
            {{ form.additional_information }}
            {% if form.additional_information.errors %}<div class="text-danger">{{ form.additional_information.errors }}</div>{% endif %}
          </div>

          <div class="mt-3 d-flex justify-content-between align-items-center flex-wrap" style="gap: .75rem;">
            <a class="btn btn-secondary" href="{% url 'organization-detail' organization.pk %}" title="Cancel and return to organization">Cancel</a>
            <button type="submit" class="btn btn-primary" title="Submit sponsorship request" {% if pending_membership_level_request %}disabled{% endif %}>Submit request</button>
          </div>
        </form>
      </div>
    </div>
  </div>
{% endblock %}
